<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
  <title>Ù…Ø±ØªØ¨â€ŒÚ©Ø±Ø¯Ù† Ø§ØªØ§Ù‚ Ø¨ÛŒâ€ŒÙ†Ø¸Ù…</title>
  <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@400;700&display=swap" rel="stylesheet">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
      user-select: none;
      -webkit-user-select: none;
    }

    body {
      font-family: 'Vazirmatn', sans-serif;
      background-color: #0c0c0c;
      color: #00ff99;
      overflow: hidden;
      height: 100dvh; /* Dynamic height for mobile browsers */
      text-shadow: 0 0 5px #00ff99;
      position: relative;
    }

    .container {
      height: 100%;
      display: flex;
      flex-direction: column;
      position: relative;
    }

    .header {
      text-align: center;
      padding: 8px;
      font-size: 1.2rem;
      font-weight: bold;
      background: rgba(0, 20, 20, 0.9);
      z-index: 10;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .timer, .stage-info {
      font-size: 0.9rem;
      background: rgba(0, 0, 0, 0.6);
      padding: 4px 10px;
      border-radius: 15px;
      border: 1px solid #00ff99;
    }

    #items-bar {
      display: flex;
      flex-wrap: nowrap; /* Horizontal scroll on mobile */
      align-items: center;
      gap: 10px;
      padding: 10px;
      background: rgba(0, 20, 20, 0.8);
      border-bottom: 2px solid #00ff99;
      height: 100px;
      overflow-x: auto;
      overflow-y: hidden;
      white-space: nowrap;
      -webkit-overflow-scrolling: touch;
    }

    .item {
      background: #1a1a1a;
      border: 2px solid #00ff99;
      border-radius: 12px;
      padding: 5px;
      text-align: center;
      cursor: grab;
      min-width: 80px;
      height: 80px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      box-shadow: 0 0 5px rgba(0, 255, 153, 0.3);
      flex-shrink: 0; /* Prevent shrinking */
      touch-action: none; /* Crucial for touch dragging */
    }

    .item.dragging {
      opacity: 0.9;
      transform: scale(1.2);
      z-index: 9999;
      position: fixed;
      pointer-events: none; /* Important: lets us detect element below */
      box-shadow: 0 10px 20px rgba(0,0,0,0.5);
    }

    .item.correct {
      opacity: 0;
      width: 0;
      margin: 0;
      padding: 0;
      min-width: 0;
      border: none;
      overflow: hidden;
      transition: all 0.5s;
    }

    .item-icon {
      font-size: 1.8rem;
      pointer-events: none;
    }

    .item-name {
      font-size: 0.8rem;
      pointer-events: none;
    }

    #room {
      flex: 1;
      position: relative;
      overflow-y: auto;
      background: #0a0a0a;
      margin: 5px;
      border-radius: 10px;
      padding: 15px;
      
      /* Grid Layout for better mobile spacing */
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(130px, 1fr));
      gap: 15px;
      align-content: start;
    }

    .drop-zone {
      aspect-ratio: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      background: rgba(0, 30, 30, 0.5);
      border: 2px dashed #00cc77;
      border-radius: 15px;
      position: relative;
      transition: all 0.2s;
      padding: 10px;
    }

    .drop-zone.active-target {
      background: rgba(0, 80, 80, 0.4);
      border-color: #ffffff;
      transform: scale(1.02);
    }

    .drop-zone-icon {
      font-size: 2.5rem;
      margin-bottom: 5px;
    }

    .drop-zone-label {
      font-size: 0.9rem;
      text-align: center;
    }

    .drop-zone.correct {
      background: rgba(0, 100, 100, 0.3);
      border-style: solid;
      border-color: #00ff99;
      box-shadow: 0 0 15px #00ff99;
      animation: pop 0.3s ease;
    }
    
    @keyframes pop {
      50% { transform: scale(1.1); }
    }

    /* Mini badge for items inside dropzone */
    .dropped-item-badge {
      position: absolute;
      bottom: 5px;
      right: 5px;
      font-size: 1.2rem;
      animation: slideIn 0.3s;
    }

    @keyframes slideIn {
      from { transform: translateY(10px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }

    .notification {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%) scale(0);
      background: rgba(255, 0, 80, 0.9);
      color: white;
      padding: 20px 30px;
      border-radius: 20px;
      border: 3px solid #ff0055;
      box-shadow: 0 0 30px #ff0055;
      font-weight: bold;
      font-size: 1.5rem;
      z-index: 2000;
      transition: transform 0.2s;
      text-align: center;
    }

    .notification.show {
      transform: translate(-50%, -50%) scale(1);
    }

    .footer {
      background: rgba(0, 10, 10, 0.95);
      padding: 8px;
      text-align: center;
      font-size: 0.8rem;
      border-top: 1px solid #00ff99;
      z-index: 100;
    }

    .welcome-screen, .game-over-screen, .victory-screen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(12, 12, 12, 0.98);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 3000;
      text-align: center;
      transition: opacity 0.5s;
      padding: 20px;
    }

    .hidden {
      display: none !important;
    }

    .welcome-message, .game-over-message, .victory-message {
      font-size: 1.5rem;
      margin-bottom: 40px;
      line-height: 1.6;
    }

    .btn {
      background: #00ff99;
      color: #0c0c0c;
      border: none;
      border-radius: 50px;
      padding: 15px 50px;
      font-family: 'Vazirmatn', sans-serif;
      font-size: 1.2rem;
      font-weight: bold;
      cursor: pointer;
      box-shadow: 0 0 20px rgba(0, 255, 153, 0.4);
      -webkit-tap-highlight-color: transparent;
    }

    .btn:active {
      transform: scale(0.95);
      background: #00cc77;
    }

    #confetti-canvas {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
    }

    /* Specific fixes for very small screens */
    @media (max-height: 600px) {
      .header { display: none; }
      #room { padding: 5px; gap: 5px; }
      .drop-zone { padding: 5px; }
      .item { height: 60px; min-width: 60px; }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
        <div class="timer">â³ <span id="time">45</span></div>
        <span>Ø§ØªØ§Ù‚ Ø¨ÛŒâ€ŒÙ†Ø¸Ù…</span>
        <div class="stage-info">Ù…Ø±Ø­Ù„Ù‡ <span id="stage">Û±</span></div>
    </div>
    
    <div id="items-bar"></div>
    
    <div id="room">
      </div>
    
    <div class="notification hidden" id="notification">âŒ Ø§Ø´ØªØ¨Ø§Ù‡Ù‡!</div>
    
    <div class="welcome-screen" id="welcome-screen">
      <div class="welcome-message">âœ¨ Ø¨Ø§Ø²ÛŒ Ù…Ø±ØªØ¨â€ŒÚ©Ø±Ø¯Ù† Ø§ØªØ§Ù‚ âœ¨<br><br>ÙˆØ³Ø§ÛŒÙ„ Ø±Ùˆ Ø¨Ú©Ø´ Ùˆ ØªÙˆÛŒ Ø¬Ø§ÛŒ Ø¯Ø±Ø³Øª Ø¨Ù†Ø¯Ø§Ø²!</div>
      <button class="btn" id="start-btn">Ø´Ø±ÙˆØ¹ Ø¨Ø§Ø²ÛŒ</button>
    </div>
    
    <div class="game-over-screen hidden" id="game-over-screen">
      <div class="game-over-message">â° Ø²Ù…Ø§Ù† ØªÙ…Ø§Ù… Ø´Ø¯!</div>
      <button class="btn" id="retry-btn">ØªÙ„Ø§Ø´ Ø¯ÙˆØ¨Ø§Ø±Ù‡</button>
    </div>
    
    <div class="victory-screen hidden" id="victory-screen">
      <div class="victory-message">ğŸ‰ Ø¢ÙØ±ÛŒÙ†! Ø§ØªØ§Ù‚ Ù…Ø±ØªØ¨ Ø´Ø¯! ğŸ‰</div>
      <canvas id="confetti-canvas"></canvas>
    </div>
    
    <div class="footer">Ø¢Ù…ÙˆØ²Ú¯Ø§Ø±: <strong>Ù…Ø¹ØµÙˆÙ…Ù‡ Ø§Ø¨Ø±Ø§Ù‡ÛŒÙ…ÛŒ</strong> | Ù…Ø¯Ø±Ø³Ù‡ <strong>Ø´Ø§ÛŒØ§Ù†</strong></div>
  </div>

  <script>
    // Prevent default scrolling only on game area
    document.body.addEventListener('touchmove', function(e) {
        if(e.target.closest('#items-bar') || e.target.closest('#room')) return;
        e.preventDefault();
    }, { passive: false });

    // Global variables
    let currentStage = 1;
    let timeLeft = 45;
    let timer;
    let items = [];
    let dropZones = [];
    let correctItems = 0;
    let totalItems = 0;
    let gameActive = false;
    let audioContext = null;
    let draggedElement = null;
    let lastTouchX = 0;
    let lastTouchY = 0;
    
    // Initialize the game
    document.addEventListener('DOMContentLoaded', () => {
      document.getElementById('start-btn').addEventListener('click', () => {
          initAudio();
          startGame();
      });
      document.getElementById('retry-btn').addEventListener('click', restartGame);
    });
    
    function initAudio() {
      if (!audioContext) {
        window.AudioContext = window.AudioContext || window.webkitAudioContext;
        if (window.AudioContext) {
          audioContext = new AudioContext();
          // Play a silent buffer to unlock audio on iOS
          const buffer = audioContext.createBuffer(1, 1, 22050);
          const source = audioContext.createBufferSource();
          source.buffer = buffer;
          source.connect(audioContext.destination);
          source.start(0);
        }
      }
      if (audioContext && audioContext.state === 'suspended') {
        audioContext.resume();
      }
    }
    
    function playSound(type) {
      if (!audioContext) return;
      try {
        const oscillator = audioContext.createOscillator();
        const gainNode = audioContext.createGain();
        oscillator.connect(gainNode);
        gainNode.connect(audioContext.destination);
        
        if (type === 'success') {
          oscillator.frequency.setValueAtTime(500, audioContext.currentTime);
          oscillator.frequency.exponentialRampToValueAtTime(1000, audioContext.currentTime + 0.1);
          oscillator.type = 'sine';
          gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
          gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.3);
          oscillator.start();
          oscillator.stop(audioContext.currentTime + 0.3);
        } else if (type === 'error') {
          oscillator.frequency.setValueAtTime(150, audioContext.currentTime);
          oscillator.frequency.linearRampToValueAtTime(100, audioContext.currentTime + 0.2);
          oscillator.type = 'sawtooth';
          gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
          gainNode.gain.linearRampToValueAtTime(0.01, audioContext.currentTime + 0.2);
          oscillator.start();
          oscillator.stop(audioContext.currentTime + 0.2);
        }
      } catch (e) { console.error(e); }
    }
    
    function shuffleArray(array) {
      const newArray = [...array];
      for (let i = newArray.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
      }
      return newArray;
    }
    
    function startGame() {
      document.getElementById('welcome-screen').classList.add('hidden');
      document.getElementById('game-over-screen').classList.add('hidden');
      document.getElementById('victory-screen').classList.add('hidden');
      gameActive = true;
      startStage(1);
    }
    
    function restartGame() {
      gameActive = true;
      startStage(1);
    }
    
    function startStage(stage) {
      if (!gameActive) return;
      currentStage = stage;
      document.getElementById('stage').textContent = stage;
      correctItems = 0;
      
      const itemsBar = document.getElementById('items-bar');
      const room = document.getElementById('room');
      itemsBar.innerHTML = '';
      room.innerHTML = '';
      
      // Data Setup
      if (stage === 1) {
        timeLeft = 45;
        items = [
          { id: "sock", name: "Ø¬ÙˆØ±Ø§Ø¨", icon: "ğŸ§¦", dropZone: "drawer" },
          { id: "banana", name: "Ù¾ÙˆØ³Øª Ù…ÙˆØ²", icon: "ğŸŒ", dropZone: "bin" },
          { id: "bag", name: "Ú©ÛŒÙ", icon: "ğŸ’", dropZone: "chair" }
        ];
        dropZones = [
          { id: "drawer", name: "Ú©Ø´Ùˆ", icon: "ğŸ—„ï¸" },
          { id: "bin", name: "Ø³Ø·Ù„ Ø¢Ø´ØºØ§Ù„", icon: "ğŸ—‘ï¸" },
          { id: "chair", name: "ØµÙ†Ø¯Ù„ÛŒ", icon: "ğŸª‘" }
        ];
      } else if (stage === 2) {
        timeLeft = 60;
        items = [
          { id: "sock", name: "Ø¬ÙˆØ±Ø§Ø¨", icon: "ğŸ§¦", dropZone: "drawer" },
          { id: "hoodie", name: "Ú©Ø§Ù¾Ø´Ù†", icon: "ğŸ§¥", dropZone: "drawer" },
          { id: "banana", name: "Ù…ÙˆØ²", icon: "ğŸŒ", dropZone: "bin" },
          { id: "trash", name: "Ú©Ø§ØºØ°", icon: "ğŸ“„", dropZone: "bin" },
          { id: "bag", name: "Ú©ÛŒÙ", icon: "ğŸ’", dropZone: "chair" },
          { id: "toy", name: "ØªÙˆÙ¾", icon: "âš½", dropZone: "chair" },
          { id: "glass", name: "Ù„ÛŒÙˆØ§Ù†", icon: "ğŸ¥›", dropZone: "sink" },
          { id: "books", name: "Ú©ØªØ§Ø¨", icon: "ğŸ“š", dropZone: "shelf" }
        ];
        dropZones = [
          { id: "drawer", name: "Ú©Ø´Ùˆ", icon: "ğŸ—„ï¸" },
          { id: "bin", name: "Ø³Ø·Ù„", icon: "ğŸ—‘ï¸" },
          { id: "chair", name: "ØµÙ†Ø¯Ù„ÛŒ", icon: "ğŸª‘" },
          { id: "sink", name: "Ø³ÛŒÙ†Ú©", icon: "ğŸš°" },
          { id: "shelf", name: "Ù‚ÙØ³Ù‡", icon: "ğŸ“š" }
        ];
      } else {
        timeLeft = 90;
        items = [
           { id: "sock", name: "Ø¬ÙˆØ±Ø§Ø¨", icon: "ğŸ§¦", dropZone: "drawer" },
           { id: "hoodie", name: "Ú©Ø§Ù¾Ø´Ù†", icon: "ğŸ§¥", dropZone: "drawer" },
           { id: "pant", name: "Ø´Ù„ÙˆØ§Ø±", icon: "ğŸ‘–", dropZone: "drawer" },
           { id: "banana", name: "Ù…ÙˆØ²", icon: "ğŸŒ", dropZone: "bin" },
           { id: "trash", name: "Ú©Ø§ØºØ°", icon: "ğŸ“„", dropZone: "bin" },
           { id: "apple", name: "Ø³ÛŒØ¨", icon: "ğŸ", dropZone: "bin" },
           { id: "bag", name: "Ú©ÛŒÙ", icon: "ğŸ’", dropZone: "chair" },
           { id: "toy", name: "Ø®Ø±Ø³", icon: "ğŸ§¸", dropZone: "chair" },
           { id: "glass", name: "Ù„ÛŒÙˆØ§Ù†", icon: "ğŸ¥›", dropZone: "sink" },
           { id: "plate", name: "Ø¨Ø´Ù‚Ø§Ø¨", icon: "ğŸ½ï¸", dropZone: "sink" },
           { id: "books", name: "Ú©ØªØ§Ø¨", icon: "ğŸ“š", dropZone: "shelf" },
           { id: "pen", name: "Ù…Ø¯Ø§Ø¯", icon: "âœï¸", dropZone: "shelf" }
        ];
        dropZones = [
          { id: "drawer", name: "Ú©Ø´Ùˆ", icon: "ğŸ—„ï¸" },
          { id: "bin", name: "Ø³Ø·Ù„", icon: "ğŸ—‘ï¸" },
          { id: "chair", name: "ØµÙ†Ø¯Ù„ÛŒ", icon: "ğŸª‘" },
          { id: "sink", name: "Ø³ÛŒÙ†Ú©", icon: "ğŸš°" },
          { id: "shelf", name: "Ù‚ÙØ³Ù‡", icon: "ğŸ“š" }
        ];
      }
      
      totalItems = items.length;
      document.getElementById('time').textContent = timeLeft;
      
      // Render Items
      shuffleArray(items).forEach(item => {
        const itemEl = document.createElement('div');
        itemEl.className = 'item';
        itemEl.id = `item-${item.id}`;
        itemEl.dataset.id = item.id;
        itemEl.innerHTML = `<div class="item-icon">${item.icon}</div><div class="item-name">${item.name}</div>`;
        
        // Touch Events
        itemEl.addEventListener('touchstart', handleTouchStart, {passive: false});
        itemEl.addEventListener('touchmove', handleTouchMove, {passive: false});
        itemEl.addEventListener('touchend', handleTouchEnd);
        
        // Mouse Events (for testing on desktop)
        itemEl.addEventListener('mousedown', handleMouseDown);
        
        itemsBar.appendChild(itemEl);
      });
      
      // Render Drop Zones
      dropZones.forEach(zone => {
        const zoneEl = document.createElement('div');
        zoneEl.className = 'drop-zone';
        zoneEl.id = `zone-${zone.id}`;
        zoneEl.dataset.id = zone.id;
        zoneEl.innerHTML = `<div class="drop-zone-icon">${zone.icon}</div><div class="drop-zone-label">${zone.name}</div>`;
        room.appendChild(zoneEl);
      });
      
      clearInterval(timer);
      timer = setInterval(updateTimer, 1000);
    }

    // --- Interaction Handlers (Optimized for Mobile) ---

    function handleTouchStart(e) {
        if (!gameActive) return;
        e.preventDefault();
        const touch = e.touches[0];
        initDrag(e.target, touch.clientX, touch.clientY);
    }

    function handleTouchMove(e) {
        if (!draggedElement) return;
        e.preventDefault();
        const touch = e.touches[0];
        moveDrag(touch.clientX, touch.clientY);
    }

    function handleTouchEnd(e) {
        if (!draggedElement) return;
        endDrag();
    }

    // Mouse fallback
    function handleMouseDown(e) {
        if (!gameActive) return;
        e.preventDefault();
        initDrag(e.target.closest('.item'), e.clientX, e.clientY);
        document.addEventListener('mousemove', handleMouseMove);
        document.addEventListener('mouseup', handleMouseUp);
    }

    function handleMouseMove(e) {
        if (!draggedElement) return;
        moveDrag(e.clientX, e.clientY);
    }

    function handleMouseUp(e) {
        document.removeEventListener('mousemove', handleMouseMove);
        document.removeEventListener('mouseup', handleMouseUp);
        endDrag();
    }

    // Core Drag Logic
    function initDrag(target, x, y) {
        draggedElement = target.closest('.item');
        if (!draggedElement) return;

        draggedElement.classList.add('dragging');
        // Initial placement
        moveDrag(x, y);
    }

    function moveDrag(x, y) {
        lastTouchX = x;
        lastTouchY = y;
        
        // Offset Y by -80px so finger doesn't cover item
        draggedElement.style.left = (x - draggedElement.offsetWidth / 2) + 'px';
        draggedElement.style.top = (y - 80) + 'px';

        // Check hover state (visual feedback)
        draggedElement.style.visibility = 'hidden'; // Hide to find element below
        let elemBelow = document.elementFromPoint(x, y);
        draggedElement.style.visibility = 'visible';

        document.querySelectorAll('.drop-zone').forEach(d => d.classList.remove('active-target'));
        if (elemBelow) {
            let dropZone = elemBelow.closest('.drop-zone');
            if (dropZone) dropZone.classList.add('active-target');
        }
    }

    function endDrag() {
        draggedElement.style.visibility = 'hidden';
        let elemBelow = document.elementFromPoint(lastTouchX, lastTouchY);
        draggedElement.style.visibility = 'visible';

        let dropZone = elemBelow ? elemBelow.closest('.drop-zone') : null;

        if (dropZone) {
            checkDrop(draggedElement, dropZone);
        } else {
            resetDrag(draggedElement);
        }
        
        draggedElement.classList.remove('dragging');
        draggedElement.style.left = '';
        draggedElement.style.top = '';
        document.querySelectorAll('.drop-zone').forEach(d => d.classList.remove('active-target'));
        draggedElement = null;
    }

    function checkDrop(itemEl, dropZoneEl) {
        const itemId = itemEl.dataset.id;
        const zoneId = dropZoneEl.dataset.id;
        const itemData = items.find(i => i.id === itemId);

        if (itemData && itemData.dropZone === zoneId) {
            // Success
            playSound('success');
            itemEl.classList.add('correct');
            
            // Add visual feedback to drop zone
            const badge = document.createElement('span');
            badge.className = 'dropped-item-badge';
            badge.textContent = itemData.icon;
            dropZoneEl.appendChild(badge);
            dropZoneEl.classList.add('correct');
            setTimeout(() => dropZoneEl.classList.remove('correct'), 300);

            correctItems++;
            checkCompletion();
        } else {
            // Failure
            playSound('error');
            showNotification();
            resetDrag(itemEl);
        }
    }

    function resetDrag(el) {
        el.style.transform = "translateX(10px)";
        setTimeout(() => el.style.transform = "translateX(-10px)", 100);
        setTimeout(() => el.style.transform = "none", 200);
    }

    function showNotification() {
        const n = document.getElementById('notification');
        n.classList.remove('hidden');
        setTimeout(() => n.classList.add('show'), 10);
        setTimeout(() => {
            n.classList.remove('show');
            setTimeout(() => n.classList.add('hidden'), 200);
        }, 1000);
    }

    function updateTimer() {
        if (!gameActive) return;
        timeLeft--;
        document.getElementById('time').textContent = timeLeft;
        if (timeLeft <= 0) {
            clearInterval(timer);
            gameActive = false;
            document.getElementById('game-over-screen').classList.remove('hidden');
        }
    }

    function checkCompletion() {
        if (correctItems >= totalItems) {
            clearInterval(timer);
            if (currentStage < 3) {
                setTimeout(() => startStage(currentStage + 1), 1000);
            } else {
                gameActive = false;
                document.getElementById('victory-screen').classList.remove('hidden');
                startConfetti();
            }
        }
    }

    function startConfetti() {
        const canvas = document.getElementById('confetti-canvas');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        
        const particles = [];
        const colors = ['#ff0055', '#00ff99', '#00ccff', '#ffcc00'];
        
        for(let i=0; i<100; i++) {
            particles.push({
                x: Math.random() * canvas.width,
                y: Math.random() * canvas.height - canvas.height,
                size: Math.random() * 8 + 4,
                color: colors[Math.floor(Math.random() * colors.length)],
                speed: Math.random() * 5 + 2
            });
        }
        
        function animate() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            particles.forEach(p => {
                p.y += p.speed;
                if(p.y > canvas.height) p.y = -20;
                ctx.fillStyle = p.color;
                ctx.fillRect(p.x, p.y, p.size, p.size);
            });
            if(!document.getElementById('victory-screen').classList.contains('hidden')) {
                requestAnimationFrame(animate);
            }
        }
        animate();
    }
  </script>
</body>
</html>
